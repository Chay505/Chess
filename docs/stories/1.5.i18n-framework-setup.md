# Story 1.5: Bilingual i18n Framework Setup

## Status
Draft

## Story
**As a** developer,
**I want** next-intl or next-i18next configured for French and English language support with route-based locale switching,
**so that** all subsequent features can be built with bilingual content from the start.

## Acceptance Criteria
1. `next-intl` (or `next-i18next`) installed and configured
2. Locale routing configured (`/en/*` and `/fr/*` routes)
3. Translation files created for `en` and `fr` locales (`messages/en.json`, `messages/fr.json`)
4. Language switcher component created (toggle between FR/EN)
5. Default locale set to English with browser detection fallback
6. Locale preference persisted in cookie
7. Test page demonstrates translated content rendering in both languages
8. Middleware configured to handle locale routing automatically

## Tasks / Subtasks
- [ ] Install next-intl (AC: 1)
  - [ ] Run `npm install next-intl`
  - [ ] Review next-intl documentation
- [ ] Configure locale routing (AC: 2)
  - [ ] Update next.config.js with i18n settings
  - [ ] Create [locale] directory structure in app/
  - [ ] Setup locale detection middleware
- [ ] Create translation files (AC: 3)
  - [ ] Create messages/en.json
  - [ ] Create messages/fr.json
  - [ ] Add common translations (navigation, buttons, etc.)
- [ ] Build language switcher component (AC: 4)
  - [ ] Create LanguageSwitcher component
  - [ ] Add FR/EN toggle button
  - [ ] Implement locale switching logic
- [ ] Configure default locale (AC: 5)
  - [ ] Set English as default
  - [ ] Add browser language detection
  - [ ] Test fallback behavior
- [ ] Implement cookie persistence (AC: 6)
  - [ ] Store locale preference in cookie
  - [ ] Read locale from cookie on page load
  - [ ] Verify persistence across sessions
- [ ] Create test page (AC: 7)
  - [ ] Add sample content with translations
  - [ ] Test language switching
  - [ ] Verify content updates correctly
- [ ] Setup middleware (AC: 8)
  - [ ] Create middleware.ts
  - [ ] Configure locale detection and routing
  - [ ] Test automatic redirects

## Dev Notes

### i18n Configuration Structure

```typescript
// app/[locale]/layout.tsx
import { NextIntlClientProvider } from 'next-intl';
import { notFound } from 'next/navigation';

export function generateStaticParams() {
  return [{ locale: 'en' }, { locale: 'fr' }];
}

export default async function LocaleLayout({
  children,
  params: { locale }
}: {
  children: React.ReactNode;
  params: { locale: string };
}) {
  let messages;
  try {
    messages = (await import(`@/messages/${locale}.json`)).default;
  } catch (error) {
    notFound();
  }

  return (
    <html lang={locale}>
      <body>
        <NextIntlClientProvider locale={locale} messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

### Translation File Structure
```json
// messages/en.json
{
  "navigation": {
    "home": "Home",
    "about": "About",
    "services": "Services",
    "contact": "Contact"
  },
  "common": {
    "bookLesson": "Book a Lesson",
    "login": "Login",
    "logout": "Logout"
  }
}

// messages/fr.json
{
  "navigation": {
    "home": "Accueil",
    "about": "À propos",
    "services": "Services",
    "contact": "Contact"
  },
  "common": {
    "bookLesson": "Réserver une leçon",
    "login": "Connexion",
    "logout": "Déconnexion"
  }
}
```

### Middleware Configuration
```typescript
// middleware.ts
import createMiddleware from 'next-intl/middleware';

export default createMiddleware({
  locales: ['en', 'fr'],
  defaultLocale: 'en',
  localeDetection: true
});

export const config = {
  matcher: ['/((?!api|_next|.*\\..*).*)']
};
```

### Language Switcher Component
```tsx
'use client';

import { useLocale } from 'next-intl';
import { useRouter, usePathname } from 'next/navigation';

export function LanguageSwitcher() {
  const locale = useLocale();
  const router = useRouter();
  const pathname = usePathname();

  const switchLocale = (newLocale: string) => {
    const newPathname = pathname.replace(`/${locale}`, `/${newLocale}`);
    router.push(newPathname);
  };

  return (
    <div>
      <button onClick={() => switchLocale('en')} disabled={locale === 'en'}>
        EN
      </button>
      <button onClick={() => switchLocale('fr')} disabled={locale === 'fr'}>
        FR
      </button>
    </div>
  );
}
```

### Testing
- **Manual Testing:** Switch between /en and /fr routes
- **Translation Verification:** Ensure all content translates correctly
- **Cookie Persistence:** Verify locale persists after page reload
- **Fallback Testing:** Test with unsupported locale (should redirect to default)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-10-24 | 1.0 | Initial story creation | John (PM Agent) |

## Dev Agent Record

### Agent Model Used
_To be populated by dev agent_

### Debug Log References
_To be populated by dev agent_

### Completion Notes List
_To be populated by dev agent_

### File List
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_
