# Test Design: Story 1.2 - Tailwind CSS Configuration

**Date:** 2025-10-24
**Designer:** Quinn (Test Architect)
**Story:** 1.2 - Tailwind CSS Configuration
**Status:** Ready for Review

---

## Test Strategy Overview

**Summary:**
- **Total test scenarios:** 18
- **Unit tests:** 8 (44%)
- **Integration tests:** 7 (39%)
- **E2E tests:** 3 (17%)

**Priority Distribution:**
- **P0:** 6 scenarios (critical configuration)
- **P1:** 8 scenarios (core functionality)
- **P2:** 4 scenarios (secondary features)

**Strategy Rationale:**
Tailwind CSS configuration is foundational infrastructure that affects all UI development. Testing focuses on:
1. Configuration correctness (unit tests for config validation)
2. Build-time compilation (integration tests for toolchain)
3. Visual rendering (E2E tests for critical UI paths)

Emphasizes fast feedback through unit tests while ensuring visual fidelity through targeted E2E tests.

---

## Test Scenarios by Acceptance Criteria

### AC1: Tailwind CSS installed and configured in `tailwind.config.ts`

**Test Coverage:** 3 scenarios

| ID           | Level       | Priority | Test Scenario                                  | Justification                                                                 |
| ------------ | ----------- | -------- | ---------------------------------------------- | ----------------------------------------------------------------------------- |
| 1.2-UNIT-001 | Unit        | P0       | Validate tailwind.config.ts structure          | Critical config file must have correct TypeScript structure and export format |
| 1.2-UNIT-002 | Unit        | P0       | Verify content paths include app directory     | Missing paths prevent Tailwind from purging unused styles                     |
| 1.2-INT-001  | Integration | P0       | Build succeeds with Tailwind compilation       | Build failure blocks all development - must pass                              |

**Scenarios Detail:**

**1.2-UNIT-001: Validate tailwind.config.ts structure**
- **Given:** tailwind.config.ts exists
- **When:** Config file is parsed
- **Then:** Valid TypeScript Config object with theme, content, plugins
- **Test Type:** Schema validation test
- **Implementation:** Import and validate config object structure

**1.2-UNIT-002: Verify content paths include app directory**
- **Given:** tailwind.config.ts loaded
- **When:** Content array is examined
- **Then:** Includes './app/**/*.{js,ts,jsx,tsx,mdx}' pattern
- **Test Type:** Configuration assertion
- **Implementation:** Check content array contains required glob patterns

**1.2-INT-001: Build succeeds with Tailwind compilation**
- **Given:** Tailwind configured
- **When:** `npm run build` executed
- **Then:** Build completes without errors, CSS generated
- **Test Type:** Build toolchain validation
- **Implementation:** Run build script, check exit code, verify output CSS exists

---

### AC2: Custom color palette defined (primary, secondary, accent colors for chess coaching brand)

**Test Coverage:** 3 scenarios

| ID           | Level       | Priority | Test Scenario                              | Justification                                                     |
| ------------ | ----------- | -------- | ------------------------------------------ | ----------------------------------------------------------------- |
| 1.2-UNIT-003 | Unit        | P0       | Validate all custom colors defined         | Missing brand colors break UI consistency - critical              |
| 1.2-INT-002  | Integration | P1       | Custom colors compile to CSS utilities     | Colors must be accessible as Tailwind classes                     |
| 1.2-E2E-001  | E2E         | P1       | Custom colors render correctly in browser  | Visual validation that colors match brand specification           |

**Scenarios Detail:**

**1.2-UNIT-003: Validate all custom colors defined**
- **Given:** tailwind.config.ts theme.extend.colors
- **When:** Config is loaded
- **Then:** Contains primary, secondary, accent, success, warning, error, neutral (50, 100, 500, 900)
- **Test Type:** Configuration completeness check
- **Implementation:** Assert all required color keys present with valid hex values

**1.2-INT-002: Custom colors compile to CSS utilities**
- **Given:** Custom colors in config
- **When:** Tailwind builds CSS
- **Then:** `.bg-primary`, `.text-secondary`, `.border-accent` utilities exist in compiled CSS
- **Test Type:** Build output validation
- **Implementation:** Parse compiled CSS, search for custom color utility classes

**1.2-E2E-001: Custom colors render correctly in browser**
- **Given:** Test page at `/tailwind-test`
- **When:** Page loads with color samples
- **Then:** Computed styles match hex values (#4A9B8E for primary, etc.)
- **Test Type:** Visual rendering validation
- **Implementation:** Playwright test checking computed color values via getComputedStyle

---

### AC3: Typography settings configured for bilingual support (FR/EN character sets)

**Test Coverage:** 3 scenarios

| ID           | Level       | Priority | Test Scenario                                 | Justification                                                        |
| ------------ | ----------- | -------- | --------------------------------------------- | -------------------------------------------------------------------- |
| 1.2-UNIT-004 | Unit        | P1       | Validate font families include system fonts   | Fallback fonts critical for character set support                    |
| 1.2-UNIT-005 | Unit        | P1       | Verify custom font sizes configured           | Typography scale must match design spec (H1-H3, base)                |
| 1.2-E2E-002  | E2E         | P2       | French and English characters render properly | Ensure bilingual support with accented characters (é, à, ç)          |

**Scenarios Detail:**

**1.2-UNIT-004: Validate font families include system fonts**
- **Given:** theme.extend.fontFamily in config
- **When:** Font family arrays examined
- **Then:** Each family includes cross-platform fallbacks (sans-serif, serif, monospace)
- **Test Type:** Configuration validation
- **Implementation:** Assert font stacks contain required fallback fonts

**1.2-UNIT-005: Verify custom font sizes configured**
- **Given:** theme.extend.fontSize in config
- **When:** Font size object loaded
- **Then:** h1 (48px), h2 (36px), h3 (24px), base (16px) defined with line heights
- **Test Type:** Typography scale validation
- **Implementation:** Check fontSize keys match spec with correct [size, lineHeight] tuples

**1.2-E2E-002: French and English characters render properly**
- **Given:** Test page with French text (École, Échecs, Français)
- **When:** Page loads
- **Then:** Accented characters display correctly without font fallback
- **Test Type:** Bilingual character support
- **Implementation:** Screenshot comparison or font-family computed style check

---

### AC4: Responsive breakpoints defined (mobile: 640px, tablet: 1024px, desktop: 1280px)

**Test Coverage:** 2 scenarios

| ID           | Level       | Priority | Test Scenario                                 | Justification                                                    |
| ------------ | ----------- | -------- | --------------------------------------------- | ---------------------------------------------------------------- |
| 1.2-UNIT-006 | Unit        | P0       | Validate breakpoints match specification      | Incorrect breakpoints cause layout failures across devices       |
| 1.2-INT-003  | Integration | P1       | Breakpoint utilities compile correctly        | Responsive classes must be available (mobile:, tablet:, desktop:)|

**Scenarios Detail:**

**1.2-UNIT-006: Validate breakpoints match specification**
- **Given:** theme.extend.screens in config
- **When:** Config loaded
- **Then:** mobile: '640px', tablet: '1024px', desktop: '1280px'
- **Test Type:** Configuration assertion
- **Implementation:** Direct value comparison against spec

**1.2-INT-003: Breakpoint utilities compile correctly**
- **Given:** Custom screens configured
- **When:** CSS compiled
- **Then:** `@media (min-width: 640px)` variants exist for mobile: prefix
- **Test Type:** Media query generation
- **Implementation:** Parse CSS for custom breakpoint media queries

---

### AC5: Global CSS file imports Tailwind directives

**Test Coverage:** 2 scenarios

| ID           | Level       | Priority | Test Scenario                                | Justification                                                |
| ------------ | ----------- | -------- | -------------------------------------------- | ------------------------------------------------------------ |
| 1.2-UNIT-007 | Unit        | P1       | Verify globals.css contains Tailwind imports | Missing directives prevent Tailwind from working             |
| 1.2-INT-004  | Integration | P1       | Layout imports globals.css                   | CSS must be loaded in root layout to affect all pages        |

**Scenarios Detail:**

**1.2-UNIT-007: Verify globals.css contains Tailwind imports**
- **Given:** app/globals.css file
- **When:** File content examined
- **Then:** Contains `@tailwind base;`, `@tailwind components;`, `@tailwind utilities;`
- **Test Type:** File content validation
- **Implementation:** Read file, assert presence of three directives

**1.2-INT-004: Layout imports globals.css**
- **Given:** app/layout.tsx
- **When:** File imports analyzed
- **Then:** Imports './globals.css'
- **Test Type:** Import chain validation
- **Implementation:** Parse layout.tsx, check for globals.css import statement

---

### AC6: Test page demonstrates Tailwind classes working (colors, typography, responsive utilities)

**Test Coverage:** 3 scenarios

| ID           | Level       | Priority | Test Scenario                                   | Justification                                                      |
| ------------ | ----------- | -------- | ----------------------------------------------- | ------------------------------------------------------------------ |
| 1.2-INT-005  | Integration | P1       | Test page route exists and renders              | Verification page must be accessible                               |
| 1.2-E2E-003  | E2E         | P1       | Test page displays color palette samples        | Visual proof that color configuration works end-to-end             |
| 1.2-INT-006  | Integration | P2       | Test page demonstrates responsive breakpoints   | Verify layout changes at mobile/tablet/desktop breakpoints         |

**Scenarios Detail:**

**1.2-INT-005: Test page route exists and renders**
- **Given:** Next.js app running
- **When:** Navigate to `/tailwind-test`
- **Then:** Page loads without 404, displays content
- **Test Type:** Route availability
- **Implementation:** HTTP request or Playwright navigation, check status 200

**1.2-E2E-003: Test page displays color palette samples**
- **Given:** `/tailwind-test` page loaded
- **When:** Page rendered in browser
- **Then:** All custom colors visible (primary, secondary, accent, neutrals)
- **Test Type:** Visual rendering validation
- **Implementation:** Playwright test checking element presence and computed colors

**1.2-INT-006: Test page demonstrates responsive breakpoints**
- **Given:** Test page with responsive grid
- **When:** Viewport resized to 639px, 640px, 1023px, 1024px, 1279px, 1280px
- **Then:** Layout changes observed at breakpoint thresholds
- **Test Type:** Responsive behavior validation
- **Implementation:** Playwright viewport testing with layout snapshot comparison

---

### AC7: Dark mode configuration added (class-based strategy for future enhancement)

**Test Coverage:** 2 scenarios

| ID           | Level       | Priority | Test Scenario                                | Justification                                               |
| ------------ | ----------- | -------- | -------------------------------------------- | ----------------------------------------------------------- |
| 1.2-UNIT-008 | Unit        | P2       | Verify dark mode strategy set to 'class'     | Enables future dark mode implementation                     |
| 1.2-INT-007  | Integration | P2       | Dark mode utilities compile in CSS           | Ensures `dark:` variant available for future use            |

**Scenarios Detail:**

**1.2-UNIT-008: Verify dark mode strategy set to 'class'**
- **Given:** tailwind.config.ts
- **When:** Config loaded
- **Then:** `darkMode: 'class'` defined
- **Test Type:** Configuration validation
- **Implementation:** Assert darkMode property value

**1.2-INT-007: Dark mode utilities compile in CSS**
- **Given:** Dark mode configured
- **When:** CSS compiled
- **Then:** `.dark:bg-primary` style exists in output
- **Test Type:** Variant generation
- **Implementation:** Parse compiled CSS for dark mode variant classes

---

## Test Level Distribution Analysis

### Unit Tests (8 scenarios - 44%)
**Rationale:** Configuration-heavy story requires extensive config validation. Unit tests provide fast feedback on configuration correctness without build overhead.

**Focus:**
- Config file structure and completeness
- Color, typography, breakpoint definitions
- Global CSS directives presence

### Integration Tests (7 scenarios - 39%)
**Rationale:** Tailwind's value comes from build-time processing. Integration tests validate that configuration correctly compiles to usable CSS utilities.

**Focus:**
- Build toolchain success
- CSS utility generation
- Import chain validation
- Route availability

### E2E Tests (3 scenarios - 17%)
**Rationale:** Limited to visual validation that configuration produces correct browser rendering. Avoids over-testing configuration through expensive E2E tests.

**Focus:**
- Color rendering accuracy
- Bilingual character support
- Visual proof of configuration working

---

## Priority Distribution Analysis

### P0 - Critical (6 scenarios)
**Justification:**
- Build success (1.2-INT-001): Blocks all development
- Configuration correctness (1.2-UNIT-001, 1.2-UNIT-002, 1.2-UNIT-003, 1.2-UNIT-006): Invalid config causes cascading failures

### P1 - High (8 scenarios)
**Justification:**
- Color and typography validation: Core brand consistency
- Test page verification: Proof that configuration works
- CSS compilation: Essential for development workflow

### P2 - Medium (4 scenarios)
**Justification:**
- Dark mode: Future enhancement, not immediately critical
- Bilingual character rendering: Important but lower risk
- Responsive layout testing: Can be visually verified manually

---

## Risk Coverage

**Identified Risks Mitigated:**

1. **RISK: Build fails due to Tailwind misconfiguration**
   - Mitigated by: 1.2-INT-001 (Build succeeds)
   - Severity: Critical
   - Probability: Medium

2. **RISK: Brand colors incorrect or missing**
   - Mitigated by: 1.2-UNIT-003, 1.2-INT-002, 1.2-E2E-001
   - Severity: High
   - Probability: Low

3. **RISK: Responsive breakpoints don't match design**
   - Mitigated by: 1.2-UNIT-006, 1.2-INT-003
   - Severity: High
   - Probability: Low

4. **RISK: French characters render incorrectly**
   - Mitigated by: 1.2-E2E-002
   - Severity: Medium
   - Probability: Low

---

## Recommended Test Execution Order

### Phase 1: Fast Feedback (Unit Tests)
Run all P0 unit tests first for immediate config validation:
1. 1.2-UNIT-001 (Config structure)
2. 1.2-UNIT-002 (Content paths)
3. 1.2-UNIT-003 (Color palette)
4. 1.2-UNIT-006 (Breakpoints)

### Phase 2: Build Validation (Critical Integration)
5. 1.2-INT-001 (Build success) - **Gate check: Must pass to proceed**

### Phase 3: Core Functionality (P1 Tests)
6. 1.2-UNIT-004, 1.2-UNIT-005 (Typography)
7. 1.2-UNIT-007 (Global CSS)
8. 1.2-INT-002 (Color utilities)
9. 1.2-INT-003 (Breakpoint utilities)
10. 1.2-INT-004 (Layout imports)
11. 1.2-INT-005 (Test page route)

### Phase 4: Visual Validation (E2E Tests)
12. 1.2-E2E-001 (Color rendering)
13. 1.2-E2E-003 (Test page display)

### Phase 5: Secondary Features (P2 Tests)
14. 1.2-E2E-002 (Bilingual support)
15. 1.2-INT-006 (Responsive behavior)
16. 1.2-UNIT-008, 1.2-INT-007 (Dark mode)

**Total estimated execution time:**
- Unit tests: ~5 seconds
- Integration tests: ~30 seconds (includes build)
- E2E tests: ~45 seconds (Playwright startup + navigation)
- **Total: ~80 seconds** for full test suite

---

## Test Coverage Gaps

**None identified.** All 7 acceptance criteria have appropriate test coverage.

---

## Quality Checklist

- [x] Every AC has test coverage
- [x] Test levels are appropriate (not over-testing)
- [x] No duplicate coverage across levels
- [x] Priorities align with business risk
- [x] Test IDs follow naming convention (1.2-{LEVEL}-{SEQ})
- [x] Scenarios are atomic and independent
- [x] Execution order optimized (fast tests first)
- [x] Risk mitigations mapped to tests

---

## Test Implementation Notes

### Recommended Testing Tools
- **Unit Tests:** Vitest for config validation
- **Integration Tests:** Vitest + filesystem checks for build validation
- **E2E Tests:** Playwright for browser rendering validation

### Test File Organization
```
apps/web/tests/
├── unit/
│   └── config/
│       └── tailwind.config.test.ts
├── integration/
│   └── build/
│       └── tailwind-build.test.ts
└── e2e/
    └── visual/
        └── tailwind-rendering.spec.ts
```

### Key Testing Patterns

**Pattern 1: Config Validation**
```typescript
// 1.2-UNIT-001 example
import tailwindConfig from '@/tailwind.config'

test('tailwind config has required structure', () => {
  expect(tailwindConfig).toHaveProperty('content')
  expect(tailwindConfig).toHaveProperty('theme')
  expect(tailwindConfig).toHaveProperty('plugins')
})
```

**Pattern 2: Build Validation**
```typescript
// 1.2-INT-001 example
import { exec } from 'child_process'

test('build succeeds with tailwind', async () => {
  const result = await exec('npm run build')
  expect(result.exitCode).toBe(0)
  expect(fs.existsSync('.next/static/css')).toBe(true)
})
```

**Pattern 3: Visual Rendering**
```typescript
// 1.2-E2E-001 example
test('custom colors render correctly', async ({ page }) => {
  await page.goto('/tailwind-test')
  const primaryColor = await page.locator('.bg-primary').evaluate(
    el => getComputedStyle(el).backgroundColor
  )
  expect(primaryColor).toBe('rgb(74, 155, 142)') // #4A9B8E
})
```

---

## Gate YAML Block

```yaml
test_design:
  scenarios_total: 18
  by_level:
    unit: 8
    integration: 7
    e2e: 3
  by_priority:
    p0: 6
    p1: 8
    p2: 4
  coverage_gaps: []
  estimated_execution_time: 80s
  critical_path_tests:
    - 1.2-INT-001  # Build must pass
    - 1.2-E2E-001  # Visual validation required
```

---

## Trace References for Requirements Traceability

- Test design matrix: `docs/qa/assessments/1.2-test-design-20251024.md`
- P0 tests identified: 6
- Total test scenarios: 18
- AC coverage: 7/7 (100%)

---

## Next Steps

1. **Implement tests** following execution order outlined above
2. **Run P0 tests** to validate critical configuration
3. **Execute full suite** before marking story as "Done"
4. **Update gate file** with test results upon completion
5. **Consider automating** in CI pipeline (estimated 80s runtime acceptable)

---

**Test Design Completed by:** Quinn (Test Architect)
**Date:** 2025-10-24
**Review Status:** Ready for development team implementation
